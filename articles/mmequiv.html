<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to mmequiv • mmequiv</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to mmequiv">
<meta name="description" content="Learn how to get started with the basics of mmequiv.
">
<meta property="og:description" content="Learn how to get started with the basics of mmequiv.
">
<meta property="og:image" content="https://kennethataylor.github.io/mmequiv/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mmequiv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/mmequiv.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/KennethATaylor/mmequiv/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to mmequiv</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KennethATaylor/mmequiv/blob/HEAD/vignettes/articles/mmequiv.Rmd" class="external-link"><code>vignettes/articles/mmequiv.Rmd</code></a></small>
      <div class="d-none name"><code>mmequiv.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>mmequiv</code> provides tools for calculating standardized
Morphine Milligram Equivalent (MME) doses for opioid medications in
research settings. This vignette will help you understand the key
functions and how to implement them in your research workflow.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kennethataylor.github.io/mmequiv/">mmequiv</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="understanding-mme-calculations">Understanding MME Calculations<a class="anchor" aria-label="anchor" href="#understanding-mme-calculations"></a>
</h2>
<p>Calculating MME is a way to compare prescription opioid medication
doses by converting different opioid medications to an equivalent
morphine dose. This standardization is essential for researchers working
with prescription opioid data, particularly in:</p>
<ul>
<li>Population-level medication utilization studies</li>
<li>Pharmacoepidemiologic research</li>
<li>Claims-based analyses</li>
</ul>
<p><code>mmequiv</code> implements the same calculations used by the <a href="https://research-mme.wakehealth.edu/" class="external-link">NIH HEAL MME Online
Calculator</a>, providing researchers with:</p>
<ul>
<li>API access to the official calculator</li>
<li>Local calculation capabilities for large datasets</li>
<li>Several standardized definitions of daily MME</li>
</ul>
</div>
<div class="section level2">
<h2 id="finding-available-medications">Finding Available Medications<a class="anchor" aria-label="anchor" href="#finding-available-medications"></a>
</h2>
<p>To see which opioid medications can be used with <code>mmequiv</code>
for MME calculation, use <code><a href="../reference/get_med_list.html">get_med_list()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the full list of supported medications and their conversion factors</span></span>
<span><span class="va">meds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_med_list.html">get_med_list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View first few rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">meds</span><span class="op">)</span></span></code></pre></div>
<p>If you’re looking for a specific medication, you can search using a
partial name:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Search for medications containing "oxy" in the name</span></span>
<span><span class="fu"><a href="../reference/search_meds.html">search_meds</a></span><span class="op">(</span><span class="st">"oxy"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-mme-calculation-using-the-nih-heal-mme-online-calculator-api">Basic MME Calculation Using the NIH HEAL MME Online Calculator
API<a class="anchor" aria-label="anchor" href="#basic-mme-calculation-using-the-nih-heal-mme-online-calculator-api"></a>
</h2>
<p>The core function in the package is <code><a href="../reference/calculate_mme.html">calculate_mme()</a></code>,
which calculates MME for one or more opioid medications for a single
patient using the NIH HEAL MME Online Calculator API. To use it, you’ll
need to provide:</p>
<ol style="list-style-type: decimal">
<li>Total therapy days (with each calendar day counted once)</li>
<li>The observation window in days</li>
<li>A list of medications with dosage information</li>
</ol>
<p>Here’s a simple example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a medications list with two medications</span></span>
<span><span class="va">meds_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    medication_name <span class="op">=</span> <span class="st">"Hydrocodone (mg)"</span>,</span>
<span>    dose <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    doses_per_24_hours <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    days_of_medication <span class="op">=</span> <span class="fl">7</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    medication_name <span class="op">=</span> <span class="st">"Oxycodone (mg)"</span>,</span>
<span>    dose <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    doses_per_24_hours <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    days_of_medication <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate MME with 7 therapy days and 14-day observation window</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_mme.html">calculate_mme</a></span><span class="op">(</span>therapy_days <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                        observation_window_days <span class="op">=</span> <span class="fl">14</span>, </span>
<span>                        medications <span class="op">=</span> <span class="va">meds_list</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="understanding-the-results">Understanding the Results<a class="anchor" aria-label="anchor" href="#understanding-the-results"></a>
</h2>
<p>Let’s examine the results of our calculation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract medication-level results</span></span>
<span><span class="va">medication_results</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">medications</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">medication_results</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract MME definitions with buprenorphine</span></span>
<span><span class="va">mme_with_bupr</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">mme_definitions</span><span class="op">$</span><span class="va">with_buprenorphine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mme_with_bupr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract MME definitions without buprenorphine</span></span>
<span><span class="va">mme_without_bupr</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">mme_definitions</span><span class="op">$</span><span class="va">without_buprenorphine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mme_without_bupr</span><span class="op">)</span></span></code></pre></div>
<p>The results include:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Patient Medication-level calculations</strong>: Each
medication’s conversion factor, MME (total), and single-day
MME.</p></li>
<li><p><strong>Patient-level summary calculations</strong>:</p></li>
</ol>
<ul>
<li>
<code>total_mme</code>: Sum of MME across all the patient’s
prescriptions</li>
<li>
<code>total_days</code>: Sum of days across all the patient’s
prescriptions</li>
<li>Four different MME/day definitions:
<ul>
<li>
<code>mme1</code>: Total MME / Total Days Supply</li>
<li>
<code>mme2</code>: Total MME / On-therapy Days</li>
<li>
<code>mme3</code>: Total MME / Observation Window Days</li>
<li>
<code>mme4</code>: Maximum Daily Dose (sum of single-day MME for all
the patient’s prescriptions)</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="when-to-use-local-calculations">When to Use Local Calculations<a class="anchor" aria-label="anchor" href="#when-to-use-local-calculations"></a>
</h2>
<p>The NIH HEAL MME Online Calculator currently has a rate limit of 50
requests per 15 minutes, where each calculation request is unique to a
patient. For datasets with substantially more than 50 patients, you can
use <code><a href="../reference/calculate_mme.html">calculate_mme_local()</a></code> which performs the exact same
calculations locally:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use local calculation (no API call)</span></span>
<span><span class="va">local_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_mme.html">calculate_mme_local</a></span><span class="op">(</span>therapy_days <span class="op">=</span> <span class="fl">7</span>, </span>
<span>                                    observation_window_days <span class="op">=</span> <span class="fl">14</span>, </span>
<span>                                    medications <span class="op">=</span> <span class="va">meds_list</span><span class="op">)</span></span></code></pre></div>
<p>The inputs and outputs are identical to <code><a href="../reference/calculate_mme.html">calculate_mme()</a></code>,
but no external API calls are made.</p>
</div>
<div class="section level2">
<h2 id="working-with-data-frames">Working with Data Frames<a class="anchor" aria-label="anchor" href="#working-with-data-frames"></a>
</h2>
<p>For real-world data analysis, you’ll often have medication data in a
data frame rather than a list. As an example, <code>mmequiv</code>
contains a synthetic dataset called <code>opioid_trial</code> that
contains one row per opioid prescription for 1000 fake patients (long
format) with each row containing the components required for MME
calculation. For large datasets that would take an annoyingly long time
to calculate using the API (recall the API rate limit of 50 patients per
15 minutes), we can use <code><a href="../reference/calculate_mme_df.html">calculate_mme_df()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View the example dataset structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">opioid_trial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate MME from a data frame</span></span>
<span><span class="va">mme_df_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_mme_df.html">calculate_mme_df</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">opioid_trial</span>,</span>
<span>  id_col <span class="op">=</span> <span class="st">"patient_id"</span>,</span>
<span>  medication_col <span class="op">=</span> <span class="st">"medication_name"</span>, </span>
<span>  dose_col <span class="op">=</span> <span class="st">"dose"</span>,</span>
<span>  doses_per_day_col <span class="op">=</span> <span class="st">"doses_per_24_hours"</span>,</span>
<span>  days_col <span class="op">=</span> <span class="st">"days_of_medication"</span>,</span>
<span>  therapy_days_col <span class="op">=</span> <span class="st">"therapy_days"</span>,</span>
<span>  observation_days_col <span class="op">=</span> <span class="st">"observation_window_days"</span>,</span>
<span>  therapy_days_without_col <span class="op">=</span> <span class="st">"therapy_days_without"</span>,</span>
<span>  observation_days_without_col <span class="op">=</span> <span class="st">"observation_window_days_without"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The results include:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Original data with MME calculations added</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mme_df_result</span><span class="op">$</span><span class="va">medications</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Patient-level summaries with buprenorphine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mme_df_result</span><span class="op">$</span><span class="va">patient_summary_with_buprenorphine</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Patient-level summaries without buprenorphine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mme_df_result</span><span class="op">$</span><span class="va">patient_summary_without_buprenorphine</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="choosing-the-right-mme-definition">Choosing the Right MME Definition<a class="anchor" aria-label="anchor" href="#choosing-the-right-mme-definition"></a>
</h2>
<p>The package calculates four different MME/day definitions, each
suited for different research questions:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>MME Definition 1 (<code>mme1</code>)</strong>: Total MME
divided by Total Days Supply</p>
<ul>
<li>Best suited for studies of immediate-release opioids prescribed for
short, discrete periods</li>
</ul>
</li>
<li>
<p><strong>MME Definition 2 (<code>mme2</code>)</strong>: Total MME
divided by On-therapy Days</p>
<ul>
<li><p>Ideal for studies of dose-dependent adverse effects (e.g.,
opioid-induced constipation)</p></li>
<li><p>Useful for patients with opioid tolerance or stable on
opioids</p></li>
</ul>
</li>
<li>
<p><strong>MME Definition 3 (<code>mme3</code>)</strong>: Total MME
divided by Fixed Observation Window</p>
<ul>
<li>Recommended by the Department of Health and Human Services Office of
the Inspector General</li>
<li>Suitable for studies with a known duration of risk (e.g., opioid use
disorder incidence)</li>
<li>Useful when prescriptions are filled at irregular intervals (PRN
basis)</li>
</ul>
</li>
<li>
<p><strong>MME Definition 4 (<code>mme4</code>)</strong>: Maximum
Daily Dose</p>
<ul>
<li>Appropriate for patients with no opioid tolerance or with
comorbidities for respiratory depression</li>
<li>Used in the CDC Opioid Guideline mobile app</li>
<li>Best for immediate dose-dependent toxic effects (e.g., respiratory
depression)</li>
</ul>
</li>
</ol>
<p>Choose the definition that best aligns with your research question
and population.</p>
</div>
<div class="section level2">
<h2 id="important-caveats">Important Caveats<a class="anchor" aria-label="anchor" href="#important-caveats"></a>
</h2>
<p>Remember that <code>mmequiv</code>, like the NIH HEAL MME Online
Calculator, is <em>only</em> intended for:</p>
<ul>
<li>Research</li>
<li>Analytical purposes using claims or dispensing data</li>
<li>Surveillance of population-level medication utilization</li>
</ul>
<p>The calculations are <strong><em>not</em></strong> intended for:</p>
<ul>
<li>Clinical decision-making while prescribing opioids</li>
<li>Clinical guidance for prescribing</li>
<li>Recommendations for converting patients from one opioid analgesic to
another</li>
</ul>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p><code>mmequiv</code> provides a comprehensive set of tools for
calculating standardized MME in research settings. Whether you’re
working with small samples through the calling the NIH HEAL MME Online
Calculator API or large datasets with local calculations, the package
offers consistent, validated methods to support your research.</p>
<p>For more information on the methodology behind these calculations,
refer to <a href="https://www.doi.org/10.1097/j.pain.0000000000003529" class="external-link">Adams, <em>et
al</em>. (2025)</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kenneth A. Taylor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
