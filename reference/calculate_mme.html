<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate morphine milligram equivalents (MME) — calculate_mme • mmequiv</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate morphine milligram equivalents (MME) — calculate_mme"><meta name="description" content="Calculates the single-day MME and total MME for each individual prescription
opioid medication submitted for calculation. Also calculates total MME,
total days of supply, and four distinct Total MME/Day calculations from
the NIH HEAL Online MME Calculator across all prescription medications
for two different medication groupings: 1) opioids without buprenorphine
and 2) opioids with buprenorphine."><meta property="og:description" content="Calculates the single-day MME and total MME for each individual prescription
opioid medication submitted for calculation. Also calculates total MME,
total days of supply, and four distinct Total MME/Day calculations from
the NIH HEAL Online MME Calculator across all prescription medications
for two different medication groupings: 1) opioids without buprenorphine
and 2) opioids with buprenorphine."><meta property="og:image" content="https://kennethataylor.github.io/mmequiv/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mmequiv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mmequiv.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/KennethATaylor/mmequiv/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate morphine milligram equivalents (MME)</h1>
      <small class="dont-index">Source: <a href="https://github.com/KennethATaylor/mmequiv/blob/HEAD/R/calculate_mme.R" class="external-link"><code>R/calculate_mme.R</code></a>, <a href="https://github.com/KennethATaylor/mmequiv/blob/HEAD/R/calculate_mme_local.R" class="external-link"><code>R/calculate_mme_local.R</code></a></small>
      <div class="d-none name"><code>calculate_mme.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the single-day MME and total MME for each individual prescription
opioid medication submitted for calculation. Also calculates total MME,
total days of supply, and four distinct Total MME/Day calculations from
the NIH HEAL Online MME Calculator across all prescription medications
for two different medication groupings: 1) opioids without buprenorphine
and 2) opioids with buprenorphine.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_mme</span><span class="op">(</span><span class="va">therapy_days</span>, <span class="va">observation_window_days</span>, <span class="va">medications</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">calculate_mme_local</span><span class="op">(</span><span class="va">therapy_days</span>, <span class="va">observation_window_days</span>, <span class="va">medications</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-therapy-days">therapy_days<a class="anchor" aria-label="anchor" href="#arg-therapy-days"></a></dt>
<dd><p>Either a single positive number or a vector of two
positive numbers indicating the sum of prescription duration (days) for
each medication, but <em>with each calendar day counted only ONCE</em>. When a
single number is provided, it is used for the both the "with
buprenorphine" and "without buprenorphine" MME calculations; when a
vector of 2 numbers is provided (e.g., <code>c(10, 18)</code>) then the first and
second numbers in the vector are used for the "with buprenorphine" and
"without buprenorphine" MME calculations, respectively. This is the
denominator for MME/Day definition 2.</p><ul><li><p>If there is only one prescription <em>or</em> if there is no calendar overlap
(i.e., no days on which more than one prescription is active) this
will be the same as the total days supply returned by the calculator
API (<code>total_days</code>).</p></li>
<li><p>If there are overlapping prescriptions, this is the number of <em>unique</em>
calendar days.</p></li>
</ul></dd>


<dt id="arg-observation-window-days">observation_window_days<a class="anchor" aria-label="anchor" href="#arg-observation-window-days"></a></dt>
<dd><p>Either a single positive number or a vector of
two positive numbers indicating a study-defined fixed observation window
of time. Typical choices are 7 day, 14 day, 30 day, 90 day. When a single
number is provided, it is used for the both the "with buprenorphine" and
"without buprenorphine" MME calculations; when a vector of 2 numbers is
provided (e.g., <code>c(7, 30)</code>) then the first and second numbers in the
vector are used for the "with buprenorphine" and "without buprenorphine"
MME calculations, respectively. This is the denominator for MME/Day
definition 3.</p></dd>


<dt id="arg-medications">medications<a class="anchor" aria-label="anchor" href="#arg-medications"></a></dt>
<dd><p>A list of medication definitions. Each element must be a
list containing each of the following fields:</p><ul><li><p><code>medication_name</code>: a string matching an API-accepted medication name and
its dosage units. To see a full list of API-accepted values, run
<code><a href="get_med_list.html">get_med_list()</a></code>.</p></li>
<li><p><code>dose</code>: a positive number indicating the dose of the associated opioid
medication listed in the <code>medication_name</code> field. Units of <code>dose</code> should
match the units listed in <code>medication_name</code>.</p></li>
<li><p><code>doses_per_24_hours</code>: a positive number indicating the number of doses in
24 hours.</p></li>
<li><p><code>days_of_medication</code>: a positive number indicating the duration of the
opioid medication prescription listed in the associated
<code>medication_name</code> in days.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of MME calculations from the API. Will error if any medications are invalid
or if any numeric parameters are not positive numbers.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>calculate_mme()</code> and <code>calculate_mme_local()</code> produce the same calculation
results with and without using the API, respectively. This helps overcome the
online calculator API rate limit of 50 (patient-level) requests per 15
minutes. In addition to returning user-specified arguments, <code>calculate_mme()</code>
also returns several  other variables mentioned in the <strong>Description</strong>
section, which are described in more detail below. Output variable
description details are below; see
<a href="https://www.doi.org/10.1097/j.pain.0000000000003529" class="external-link">Adams, <em>et al</em>. (2025)</a>
for a comprehensive overview.</p>
    </div>
    <div class="section level2">
    <h2 id="prescription-level">Prescription-Level<a class="anchor" aria-label="anchor" href="#prescription-level"></a></h2>
    <p><strong>Conversion Factor for &lt;<code>medication_name</code>&gt;</strong> (<code>factor</code>): the conversion
factor used for calculating total MME/day.</p>
<p><strong>MME for &lt;<code>medication_name</code>&gt;</strong> (<code>mme</code>): Morphine milligram equivalent
for the whole prescription specified in <code>medication_name</code>, calculated as
<code>(dose) * (doses_per_24_hours) * (factor) * (days_of_medication)</code>.</p>
<p><strong>24h MME for &lt;<code>medication_name</code>&gt;</strong> (<code>single_day_mme</code>): Morphine milligram
equivalent for the prescription specified in <code>medication_name</code> for a
single day, calculated as <code>(dose) * (doses_per_24_hours) * (factor)</code>.</p>
<p><strong>One day</strong>: Typically, the day with highest opioid exposure is entered, and
the sum of 24-hour MME across the drugs that apply to this day is
calculated. Highest MME in one day is definition 4.</p>
    </div>
    <div class="section level2">
    <h2 id="summary-level-">Summary-Level:<a class="anchor" aria-label="anchor" href="#summary-level-"></a></h2>
    <p><strong>On-therapy Days</strong> (<code>therapy_days</code>): The sum of prescription duration
(<code>days_of_medication</code>) for each medication, but <em>with each calendar day
counted only ONCE</em>. User-supplied; this is the denominator for MME/Day
definition 2.</p><ul><li><p>If there is only one prescription, or if there is no calendar overlap
(no days on which more than one prescription is active), this will be
the same as the total days supply.</p></li>
<li><p>If there are overlapping prescriptions, this is the number of unique
calendar days.</p></li>
</ul><p><strong>Total MME</strong> (<code>total_mme</code>): The MME for each medication, summed across all prescriptions.
This is the numerator for MME/Day definitions 1, 2, and 3.</p>
<p><strong>Total Days Supply</strong> (<code>total_days</code>): The sum of the entered prescription
duration (<code>days_of_medication</code>) for each of the <code>medications</code> (Med 1
duration + med 2 duration...). Automatically calculated. This is the
denominator for MME/Day definition 1.</p><div class="section">
<h3 id="mme-day">MME/Day<a class="anchor" aria-label="anchor" href="#mme-day"></a></h3>


<p>MME/Day is an aggregate measure, calculating the total MME divided by a
specified time window (a number of days). The MME/Day definitions specify
the number of days:</p>
<p><strong>MME/Day Definition 1 (<code>mme1</code>): Total Days Supply</strong></p>
<p>MME Definition 1 = Total MME / Total Days Supply time window (sum of entered prescription durations).</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">mme1</span> <span class="op">=</span> <span class="va">total_mme</span> <span class="op">/</span> <span class="va">total_days</span></span></code></pre><p></p></div><ul><li><p>Note that the same calendar day may contribute multiple times, if
overlapping prescriptions.</p></li>
<li><p>Reason to select this definition: This is the least complicated
calculation; appears best suited when immediate-release opioids are
prescribed for short discrete times.</p></li>
<li><p>Identified challenge with this definition: It consistently underestimated
MME per day when overlapping prescriptions were present or when
immediate-release and extended release opioids were prescribed
concurrently.</p></li>
</ul><p><strong>MME/Day Definition 2 (<code>mme2</code>): On-therapy Days</strong></p>
<p>MME Definition 2 = Total MME / On-therapy Days time window (sum of entered
prescription durations except each calendar day is counted only ONCE).</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">mme2</span> <span class="op">=</span> <span class="va">total_mme</span> <span class="op">/</span> <span class="va">therapy_days</span></span></code></pre><p></p></div><ul><li><p>Note - On-therapy Days unique calendar days.</p></li>
<li><p>Reason to select this definition: Provides a smoothed measure useful in
studies of dose-dependent adverse effects, including opioid-induced
constipation or overdose in patients with opioid tolerance or who have
been stable on opioids.</p></li>
<li><p>Identified challenge with this definition: The metric is time-varying and
affords the greatest flexibility to define medication gap periods and
leftover/unused medications to improve pharmacoepidemiologic studies.</p></li>
</ul><p><strong>MME/Day Definition 3 (<code>mme3</code>): Fixed Observation Window</strong></p>
<p>Uses the Total MME study-specified fixed observation window. MME Definition
3 = Total MME / Number of days in observation window:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">mme3</span> <span class="op">=</span> <span class="va">total_mme</span> <span class="op">/</span> <span class="va">observation_window_days</span></span></code></pre><p></p></div><ul><li><p>If this definition is selected, it is important to report on the duration
of the fixed window.</p></li>
<li><p>Reason to select this definition: Most suitable for studies with a known
or suspected duration of risk during which adverse events are expected
to occur, such as incidence of opioid use disorder. This definition may
be useful when prescriptions are filled at irregular time intervals on a
as needed basis (<em>pro re nata</em>, PRN).</p></li>
<li><p>Identified challenge with this definition: The definition consistently had
the lowest milligrams per day for immediate-release opioids. It is the
most robust to misspecification, amenable to transformations, and has
the least noise when constructing continuous functions. However, since
it assumes uniform exposure/risk within a window, there is less scope
for time-varying adjustment.</p></li>
<li><p>This is the definition recommended by the Department of Health and Human
Services Office of the Inspector General.</p></li>
</ul><p><strong>MME/Day Definition 4 (<code>mme4</code>): Maximum Daily Dose</strong></p>
<p>Uses the sum of 24-hour MME for the day with highest opioid exposure.</p>
<p>MME Definition 4 = Drug 1 (dose (mg) x # of doses per day) x conversion
factor + Drug 2 (dose (mg) x # of doses per day) x conversion factor + ...</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">mme4</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dose</span> <span class="op">*</span> <span class="va">doses_per_24_hours</span> <span class="op">*</span> <span class="va">factor</span><span class="op">)</span></span></code></pre><p></p></div><ul><li><p>Report the highest single-day exposure.</p></li>
<li><p>Reason to select this definition: A toxicological perspective may be
appropriate for patients with no opioid tolerance and in the presence
of comorbidities for respiratory depression. It appears to be best
suited for immediate dose-dependent toxic effects, such as respiratory
depression.</p></li>
<li><p>Identified challenged with this definition: This definition may have
limited use if it includes opioids where fatal toxicity does not involve
respiratory depression (e.g., tramadol) or have atypical <em>mu</em>-opioid
receptor agonism (e.g., tapentadol, buprenorphine).</p></li>
<li><p>The definition assumes uniform risk of adverse outcomes regardless of time
on-therapy. More so than the others, this definition is prone to
influence from early refills, unused medication, and how the 90 MME
threshold is operationalized.</p></li>
<li><p>This definition underlies the algorithm embedded in the CDC Opioid
Guideline mobile app. There may be difficulty reconciling findings with
studies using the other definitions because it returns a MME per day
that is significantly higher.</p></li>
<li><p>This calculator sums the 24-hour MME for every prescription, without
considering calendar dates.</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="calculate_mme_df.html">calculate_mme_df()</a></code> which this function wraps.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">meds_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    medication_name <span class="op">=</span> <span class="st">"Buprenorphine buccal film (mcg) buccal"</span>,</span></span>
<span class="r-in"><span>    dose <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    doses_per_24_hours <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    days_of_medication <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    medication_name <span class="op">=</span> <span class="st">"Hydrocodone (mg)"</span>,</span></span>
<span class="r-in"><span>    dose <span class="op">=</span> <span class="fl">75</span>,</span></span>
<span class="r-in"><span>    doses_per_24_hours <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    days_of_medication <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">calculate_mme</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="va">meds_list</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Processed medications"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $therapy_obs_window_with</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $therapy_obs_window_with$therapy_days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $therapy_obs_window_with$observation_window_days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $therapy_obs_window_without</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $therapy_obs_window_without$therapy_days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $therapy_obs_window_without$observation_window_days</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $medications</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          medication_name dose doses_per_24_hours</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Buprenorphine buccal film (mcg) buccal   50                  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                       Hydrocodone (mg)   75                  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   days_of_medication factor    mme single_day_mme</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                  5  0.039   19.5            3.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                 10  1.000 2250.0          225.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mme_definitions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mme_definitions$with_buprenorphine</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   total_mme total_days  mme1   mme2  mme3  mme4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    2269.5         15 151.3 226.95 453.9 228.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mme_definitions$without_buprenorphine</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   total_mme total_days mme1 mme2 mme3 mme4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      2250         10  225  225  450  225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clean up meds_list</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">meds_list</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kenneth A. Taylor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

